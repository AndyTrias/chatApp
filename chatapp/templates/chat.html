{% extends "layout.html" %}
{% block main %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.js" integrity="sha512-MgkNs0gNdrnOM7k+0L+wgiRc5aLgl74sJQKbIWegVIMvVGPc1+gc1L2oK9Wf/D9pq58eqIJAxOonYPVE5UwUFA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script type="text/javascript">let myContact = {{contact.contact_id }};</script>
<script type="text/javascript" src="{{url_for('static', filename='socket.js')}}"></script>

    <div class="">
        <div class="d-flex justify-content-center align-items-center">
            <div class="pt-3 pe-3 chat-container" data-mdb-perfect-scrollbar="true">
                <div class="chat">
                    {% for message in messages %}
{#                          Messages sent from user                            #}
                        {% if message.sender_id == current_user.id %}
                            <div class="d-flex flex-row justify-content-start">
                                <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava5-bg.webp" alt="avatar 1" style="width: 45px; height: 100%;">
                                <div class="message-container">
                                <p class="small p-2 ms-3 mb-1 rounded-3 message-content">{{message.content}}</p>
                                <p class="small ms-3 mb-3 rounded-3 text-muted float-end">{{message.sentAt}}</p>
                                </div>
                            </div>

                        {% else %}
{#                              Messages sent from contact to user#}
                            <div class="d-flex flex-row justify-content-end">
                                <div class="received">
                                    <p class="small rounded-3 content">{{message.content}}</p>
                                    <p class="small me-3 mb-3 rounded-3 text-muted float-end">{{message.sentAt}}</p>
                                </div>
                                <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava6-bg.webp" alt="avatar 1" style="width: 45px; height: 100%;">
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>

                <div class="text-muted d-flex justify-content-start align-items-center">
                    <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava6-bg.webp" alt="avatar 3"
                        style="width: 40px; height: 100%;">
                    <input type="text" class="form-control form-control-lg" id = "message" autofocus placeholder="Type message">
                    <button class="ms-3 btn btn-success" id = "sendmsg">Send</button>
                </div>
            </div>
        </div>
    </div>

    <div class="bg"></div>
        <div class="bg bg2"></div>
        <div class="bg bg3"></div>
    </div>

    
{% endblock %}